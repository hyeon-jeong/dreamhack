r
gdb -q ./canary
q
b *main+8
r
ni
b *main+50
c
r
c
$rbp-0x8
print /a $rbp-0x8
si
ni
q
info register
info register fs
print $fs
print $cs
r
b *main
r
print $cs
q
catch syscall arch_prctl
r
info register $rdi
info register $rsi
x/gx 0x7ffff7fe24c0+0x28
watch *(0x7ffff7fe24c0+0x28)
c
x/gx 0x7ffff7fe24c0+0x28
c
x/gx 0x7ffff7fe24c0+0x28
b *main
c
si
q
b *main
r
catch syscall arhch_prctl
cahch syscall arch_prctl
catch syscall arch_prctl
si
c
r
watch *(0x7ffff7fe24c0+0x28)
si
x/gx 0x36f5ee288edd13e0+0x28
x/gx 0x36f5ee288edd13e0
q
b *main
catch syscall arch_prctl
r
x/gx 0x7ffff7fe24c0+0x28
watch *0x7ffff7fe24e8
c
x/gx 0x7ffff7fe24e8
disas main
b *0x000006f6
r
disas main
b *0x565556f6
quit
disas main
b *0x6f6
r
q
disas main
q
disas main
q
disas main
b *0x6f6
r
x/3wx $esp
x/40wx 0xffffd534
x/40wx 0xffffd292
q
p give_shell
q
